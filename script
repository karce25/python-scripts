import csv

# File paths (update these)
mapping_file = "mapping.csv"        # Contains columns: current_ip,new_ip
subset_file = "subset.csv"          # Contains column: current_ip
output_file = "mapped_ips.csv"      # Output file

# Step 1: Read mapping into a dictionary
mapping = {}
with open(mapping_file, newline='') as f:
    reader = csv.DictReader(f)
    for row in reader:
        mapping[row['current_ip']] = row['new_ip']

# Step 2: Read subset and look up corresponding new IPs
results = []
with open(subset_file, newline='') as f:
    reader = csv.DictReader(f)
    for row in reader:
        current_ip = row['current_ip']
        new_ip = mapping.get(current_ip, "")  # empty if not found
        results.append({'current_ip': current_ip, 'new_ip': new_ip})

# Step 3: Write output
with open(output_file, 'w', newline='') as f:
    fieldnames = ['current_ip', 'new_ip']
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerows(results)

print(f"âœ… Mapping complete. Results saved to {output_file}")
